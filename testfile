                stage('validate: manifest') {
                    logStage('validate-manifest')
                    script {
                        // Load YAML from shared library
                        def yamlText = libraryResource 'foundation-manifests.yml'
                        def foundationManifests = readYaml text: yamlText

                        // Resolve manifests for the selected foundation
                        manifestList = foundationManifests[pcfFoundation]

                        if (!manifestList) {
                            error "‚ùå No manifest mapping found for PCF foundation: ${pcfFoundation}"
                        }

                        echo "‚úÖ Resolved manifest(s) for ${pcfFoundation}: ${manifestList}"

                        // Validate each manifest
                        manifestList.each { manifestFile ->
                            echo "üîç Validating manifest: ${manifestFile}"
                            if (fileExists(manifestFile)) {
                                validateSplunkIndex(manifestFile, 'prod')
                            } else {
                                buildFailed("‚ùå No manifest file found: ${manifestFile}")
                            }
                        }
                    }
                }




          // UDeploy: Import Artifact Stage
                // ----------------------------
                stage('udeploy: import-artifact') {
                    logStage('udeploy-import-artifact')
                    script {
                        manifestList.each { manifestFile ->
                            echo "üöÄ Importing artifact with manifest: ${manifestFile}"
                            if (!fileExists(manifestFile)) {
                                error "‚ùå Manifest file not found during import: ${manifestFile}"
                            }
                            uDeployDevVersionImport(gitRepositoryName, appVersion, manifestFile, pcfRoute)
                        }
                    }
                }
